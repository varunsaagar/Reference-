NLQ	SQL	DB Response		
Find the total number of smart phone upgrade after Jun month grouped by month and exclude any orders through resellers	"select FORMAT_DATE('%b %Y', coalesce(a.invc_dt,a.pymnt_dt)) session_mth, count(*)
FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.equip_sum_fact` a
WHERE a.rpt_mth > '2024-06-30'
    AND a.acq_ret_ind = 'R'
    AND a.NET_SALES>0
    AND a.FIN_UPG_FLAG='Y'
    AND upper(a.ORDER_TYPE) = 'PS'
    AND a.REV_GEN_IND='Y'
    AND a.sls_dist_chnl_type_cd <> 'W'
    AND trim(lower(coalesce(a.device_prod_nm, a.prod_nm))) IN (SELECT trim(lower(prod_nm)) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.device_dp_map` WHERE lower(data_tier_fin) = 'smartphone') 
    group by 1"	"session_mth        f0_
Sep-24        1398025
Nov-24        1254428
Oct-24        1478881
Aug-24        1019013
May-24        1
Jul-24        1067538
Jun-24        863
"	Complex	
Find the number of abandoned calls based on department for the latest available information but exclude prepay calls. I also need to know average, min and max time before the call is abandoned	"SELECT    ECCR_DEPT_NM  , COUNT(ACD_AREA_NM), AVG(TIME_TO_ABAND_SECONDS), MIN(TIME_TO_ABAND_SECONDS), MAX(TIME_TO_ABAND_SECONDS)
FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact` WHERE ABANDONS_CNT = 1 AND CALL_END_DT = DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY)  AND ACD_AREA_NM <> 'Prepay'
GROUP BY ECCR_DEPT_NM"	"ECCR_DEPT_NM	f0_	f1_	f2_	f3_
Care	17338	753.92213634790585	6	9104
Tech	3821	204.92488877257315	6	3756
Ignore Department	1187	205.11625947767479	6	1247
Inside Sales	756	364.69444444444434	6	1226
LNP	189	140.48148148148147	6	2017
LNP General Ticket	333	2301.5285285285327	15	2706
LNP Wireline Ticket	327	2567.5779816513759	15	2706
Bilingual	511	844.02739726027414	8	4454
Business Inside Sales	19	155.0	9	527
BSC	80	276.97499999999997	23	929
CORe	152	93.34210526315789	6	855"	Simple	
Find the number of first time callers on Jun 1st who did not call before in the last 30 days	"with callbase as (
SELECT * FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact` where call_answer_dt = cast('2024-06-01' as date) and acss_call_id is not null  )

,last30dayscallers as (
select distinct cust_id,mtn from `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact` where call_answer_dt between cast('2024-06-01' as date) - 30 and cast('2024-06-01' as date) - 1 and acss_call_id is not null  )

--,firsttimecallers as (
  select count(*) from callbase a left join last30dayscallers b on (concat(a.cust_id,a.mtn)) = (concat(b.cust_id,b.mtn)) where b.cust_id is null
--)"	96380	Complex	
Find the number of postpaid customers using Mobile and Home products and also group by customer having only mobile, only home and both mobile and home products	"select mobile_home_grp, count(1) from (
Select cust_id,acct_num,
case 
  when line_cnt=1 and fwa_ind=1 then 'Home_Only_acct'
  when line_cnt>1 and fwa_ind=1 then 'Mobile_Home_acct'
  when line_cnt>=1 and fwa_ind=0 then 'Mobile_Only_acct'
else null
end as mobile_home_grp
from 
(
Select cust_id,acct_num ,count(distinct mtn) as line_cnt,
max(case when fwa_ind='Y' then 1 else 0 end) as fwa_ind from 
(
select cust_id,acct_num,mtn,
CASE
              WHEN Upper ( PPLAN.coe_pplan_sub_type_desc ) LIKE '%HOME%'
              THEN 'Y'
              ELSE 'N'
          END AS fwa_ind
 FROM 
  vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.subs_sum_fact SSF

  INNER JOIN vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.vz2_segmt_dim_ref SEG
    ON SEG.VZ2_SEGMT_CD = SSF.vz2_segmt_cd
    AND SEG.CURR_PREV_IND = 'C'
    AND SEG.VZ2_SEGMT_CTGRY_DESC = 'Wireless Consumer Revenue'

LEFT JOIN vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.price_plan PPLAN 
    on ssf.pplan_cd = PPLAN.pplan_cd
    AND upper(PPLAN.coe_pplan_service_type_desc) = 'POSTPAID'

WHERE 
    SSF.RPT_MTH = '2024-05-01'
    AND COALESCE(TRIM(SSF.MANAGED_IND),'C') <> 'U' -- CONSOLIDATED MARKETS ONLY
    AND COALESCE(SSF.LINE_TYPE_CD, 'X') NOT IN ('H','0','T') --  FILTER OUT M2M
    AND COALESCE(SSF.PREPAID_IND, 'N') <> 'Y'  -- FILTER OUT PREPAID  
)x
group by 1,2
)Z
group by 1,2,3)
group by 1"	"mobile_home_grp	f0_
Mobile_Only_acct	30999085
Mobile_Home_acct	1802399
Home_Only_acct	488620
"	Complex	Simple
How many customers have late payment fee for the current month	SELECT count(*) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.acct_bill` where cyc_mth_yr = '202411' and late_pymnt_chrg_amt > 0	"f0_
5386811"	Simple	
Find all the plan code for all myPlans 	SELECT * FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.price_plan` where coe_pplan_ctgry_desc = 'myPlans'	"sor_id	pplan_cd	pplan_mkt_cd	pplan_type_cd	pplan_desc	access_amt	anlg_dgtl_ind	pk_allow_min	off_pk_allow_min	tot_allow_min	first_incnmg_min_free_ind	pk_min_rt	off_pk_min_rt	wkend_rt_ind	wkend_min_rt	mtn_to_mtn_min_rt	vz_ld_pk_rt	vz_ld_off_pk_rt	vz_ld_rt_id	vz_ld_rt_desc	non_vz_off_pk_rt	non_vz_pk_rt	mobreach_off_pk_rt	mobreach_pk_rt	eff_dt	access_tier_num	allow_tier_num	term_ind	cntrct_term_ind	mtn_to_mtn_optn_ind	act_fee	prepaid_ind	ctgry_cd	sprss_ind	segmt_cd	singl_rt_usa	last_upd_dt	std_access_tier_num	budget_access_tier_num	omni_roamer_typ_cd	pplan_handset_req_cd	pplan_geo_cd	pplan_home_rt_cvrg_cd	pplan_brand_nm_cd	pplan_share_cd	pplan_pymnt_type_cd	pplan_prod_line_cd	pplan_class_cd	pplan_footprint_nm	pplan_promo_cd	pplan_bndl_type_cd	eis_inc_ind	bill_in_arrear_ind	alltel_product_grp_key	collect_cd	data_access_amt	pri_sec_ind	pplan_processing_type_cd	pplan_line_acct_cd	msg_allow_cnt	msg_incoming_rt	msg_outgoing_rt	data_allow_cnt	data_peak_rt	data_off_peak_rt	data_anytime_rt	data_unit_meas_desc	bi_pplan_desc	bi_pplan_desc_abbrv	bi_pplan_service_type_cd	bi_pplan_service_type_desc	bi_pplan_service_type_desc_abr	bi_pplan_type_cd	bi_pplan_type_desc	bi_pplan_type_desc_abbrv	bi_pplan_sub_type_cd	bi_pplan_sub_type_desc	bi_pplan_sub_type_desc_abbrv	bi_pplan_class_cd	bi_pplan_class_desc	bi_pplan_class_desc_abbrv	bi_pplan_ctgry_cd	bi_pplan_ctgry_desc	bi_pplan_ctgry_desc_abbrv	bi_pplan_segmt_key	bi_pplan_segmt_cd	bi_pplan_segmt_desc	bi_pplan_segmt_grp_cd	bi_pplan_segmt_grp_desc	bi_data_allow_tier_cd	bi_data_allow_tier_desc	bi_data_allow_tier_desc_abbrv	bi_data_allow_tier_value	bi_data_allow_tier_unit_meas	bi_pplan_term_ind	bi_pplan_rpt_key	bi_rpt_pplan_cd	bi_rpt_pplan_desc	bi_rpt_pplan_desc_abbrv	bi_pplan_access_amt	bi_pplan_tot_allow_min	bi_pplan_pk_allow_min	bi_pplan_msg_allow_cnt	msg_allow_share_ind	data_allow_share_ind	voice_allow_share_ind	data_ovg_unit_of_meas_desc	coe_pplan_class_desc	coe_pplan_ctgry_desc	coe_pplan_type_desc	coe_pplan_sub_type_desc	coe_prod_type_cd	coe_pplan_group	coe_voice_pplan_access_amt	coe_data_pplan_access_amt	coe_pplan_segmt_desc	coe_pplan_service_type_desc	price_plan_desc
V	63217	978		UNLIMITED PLUS (SMARTPHONE)	0	D	0	0	99999	N	0.25	0.25	N	0	0	0	0	1	NANP FREE CAN/MEX/PR/USVI		0.25	0	0	2022-11-07	1	14	N	24	N	0	N	92		07		2024-12-02	0	0										AC NO ROAM NATIONWIDE		B 	Y			VPUNL	0		VPC	L	0	0	0	9999999999	0	0	0	MB	UNLIMITED PLUS (SMARTPHONE)	UNLIMITED PLUS (SMARTPHONE)	ST.POST	Postpaid	Postpaid	ST.POST.2193	myPlans	myPlans	ST.POST.2197	Unlimited Plus	Unlimited Plus	ST.POST.2000	Non Share	Non Share	ST.POST.2001	Single Line	Single Line		ST.SGMT.07	Other Consumer Plans	ST.SGMT.0001	Consumer Plans						N	ST.POST.V.63217	ST.POST.V.63217	UNLIMITED PLUS (SMARTPHONE)	UNLIMITED PLUS (SMARTPHONE)	0	99999	0	0	N	N	N	GB	Unlimited Data	myPlans	Unlimited Plus	Unlimited Plus	VMD	Voice_Messaging_Data	0	0	Other Consumer Plans	Postpaid	
V	63216	978		UNLIMITED PLUS (BASIC PHONE)	0	D	0	0	99999	N	0.25	0.25	N	0	0	0	0	1	NANP FREE CAN/MEX/PR/USVI		0.25	0	0	2022-11-07	1	14	N	24	N	0	N	92		07		2024-12-02	0	0										AC NO ROAM NATIONWIDE		B 	Y			VPUNL	0		VPC	L	0	0	0	9999999999	0	0	0	MB	UNLIMITED PLUS (BASIC PHONE)	UNLIMITED PLUS (BASIC PHONE)	ST.POST	Postpaid	Postpaid	ST.POST.2193	myPlans	myPlans	ST.POST.2197	Unlimited Plus	Unlimited Plus	ST.POST.2000	Non Share	Non Share	ST.POST.2001	Single Line	Single Line		ST.SGMT.07	Other Consumer Plans	ST.SGMT.0001	Consumer Plans						N	ST.POST.V.63216	ST.POST.V.63216	UNLIMITED PLUS (BASIC PHONE)	UNLIMITED PLUS (BASIC PHONE)	0	99999	0	0	N	N	N	GB	Unlimited Data	myPlans	Unlimited Plus	Unlimited Plus	VMD	Voice_Messaging_Data	0	0	Other Consumer Plans	Postpaid	
V	63215	978		UNLIMITED WELCOME (SMARTPHONE)	0	D	0	0	99999	N	0.25	0.25	N	0	0	0	0	1	NANP FREE CAN/MEX/PR/USVI		0.25	0	0	2022-11-07	1	14	N	24	N	0	N	92		07		2024-12-02	0	0										AC NO ROAM NATIONWIDE		B 	Y			VPUNL	0		VPC	L	0	0	0	9999999999	0	0	0	MB	UNLIMITED WELCOME (SMARTPHONE)	UNLIMITED WELCOME (SMARTPHONE)	ST.POST	Postpaid	Postpaid	ST.POST.2193	myPlans	myPlans	ST.POST.2194	Unlimited Welcome	Unlimited Welcome	ST.POST.2000	Non Share	Non Share	ST.POST.2001	Single Line	Single Line		ST.SGMT.07	Other Consumer Plans	ST.SGMT.0001	Consumer Plans						N	ST.POST.V.63215	ST.POST.V.63215	UNLIMITED WELCOME (SMARTPHONE)	UNLIMITED WELCOME (SMARTPHONE)	0	99999	0	0	N	N	N	GB	Unlimited Data	myPlans	Unlimited Welcome	Unlimited Welcome	VMD	Voice_Messaging_Data	0	0	Other Consumer Plans	Postpaid	
V	63214	978		UNLIMITED WELCOME (BASIC PHONE)	0	D	0	0	99999	N	0.25	0.25	N	0	0	0	0	1	NANP FREE CAN/MEX/PR/USVI		0.25	0	0	2022-11-07	1	14	N	24	N	0	N	92		07		2024-12-02	0	0										AC NO ROAM NATIONWIDE		B 	Y			VPUNL	0		VPC	L	0	0	0	9999999999	0	0	0	MB	UNLIMITED WELCOME (BASIC PHONE)	UNLIMITED WELCOME (BASIC PHONE)	ST.POST	Postpaid	Postpaid	ST.POST.2193	myPlans	myPlans	ST.POST.2194	Unlimited Welcome	Unlimited Welcome	ST.POST.2000	Non Share	Non Share	ST.POST.2001	Single Line	Single Line		ST.SGMT.07	Other Consumer Plans	ST.SGMT.0001	Consumer Plans						N	ST.POST.V.63214	ST.POST.V.63214	UNLIMITED WELCOME (BASIC PHONE)	UNLIMITED WELCOME (BASIC PHONE)	0	99999	0	0	N	N	N	GB	Unlimited Data	myPlans	Unlimited Welcome	Unlimited Welcome	VMD	Voice_Messaging_Data	0	0	Other Consumer Plans	Postpaid	
V	69185	978		UNLIMITED ULTIMATE (SMARTPHONE)	0	D	0	0	99999	N	0.25	0.25	N	0	0	0	0	1	NANP FREE CAN/MEX/PR/USVI		0.25	0	0	2023-06-21	1	14	N	24	N	0	N	92		07		2024-12-02	0	0										AC NO ROAM NATIONWIDE		B 	Y			VPUNL	0		VPC	L	0	0	0	9999999999	0	0	0	MB	UNLIMITED ULTIMATE (SMARTPHONE)	UNLIMITED ULTIMATE (SMARTPHONE)	ST.POST	Postpaid	Postpaid	ST.POST.2193	myPlans	myPlans	ST.POST.2207	Unlimited Ultimate	Unlimited Ultimate	ST.POST.2000	Non Share	Non Share	ST.POST.2001	Single Line	Single Line		ST.SGMT.07	Other Consumer Plans	ST.SGMT.0001	Consumer Plans						N	ST.POST.V.69185	ST.POST.V.69185	UNLIMITED ULTIMATE (SMARTPHONE)	UNLIMITED ULTIMATE (SMARTPHONE)	0	99999	0	0	N	N	N	GB	Unlimited Data	myPlans	Unlimited Ultimate	Unlimited Ultimate	VMD	Voice_Messaging_Data	0	0	Other Consumer Plans	Postpaid	
V	69183	978		UNLIMITED ULTIMATE (BASIC PHONE)	0	D	0	0	99999	N	0.25	0.25	N	0	0	0	0	1	NANP FREE CAN/MEX/PR/USVI		0.25	0	0	2023-06-21	1	14	N	24	N	0	N	92		07		2024-12-02	0	0										AC NO ROAM NATIONWIDE		B 	Y			VPUNL	0		VPC	L	0	0	0	9999999999	0	0	0	MB	UNLIMITED ULTIMATE (BASIC PHONE)	UNLIMITED ULTIMATE (BASIC PHONE)	ST.POST	Postpaid	Postpaid	ST.POST.2193	myPlans	myPlans	ST.POST.2207	Unlimited Ultimate	Unlimited Ultimate	ST.POST.2000	Non Share	Non Share	ST.POST.2001	Single Line	Single Line		ST.SGMT.07	Other Consumer Plans	ST.SGMT.0001	Consumer Plans						N	ST.POST.V.69183	ST.POST.V.69183	UNLIMITED ULTIMATE (BASIC PHONE)	UNLIMITED ULTIMATE (BASIC PHONE)	0	99999	0	0	N	N	N	GB	Unlimited Data	myPlans	Unlimited Ultimate	Unlimited Ultimate	VMD	Voice_Messaging_Data	0	0	Other Consumer Plans	Postpaid	"	Simple	
Find all active customers who have myPlans and limit to smartphone plans only 	"SELECT pplan_cd, count(*) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line_pplan` a left join `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line` b on (a.cust_id = b.cust_id and a.cust_line_seq_id = b.cust_line_seq_id)
where
b.mtn_status_ind = 'A' and 
b.vsn_cust_type_cd in ('PE','ME') and
a.pplan_cd in ('63217','63215','69185')
group by a.pplan_cd;

"	<< b.consumer_ind>> not found	Simple	
Find me total number of IVR calls for 2024 and categorize by month	"SELECT EXTRACT(MONTH FROM ivr_call_dt), count(*) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.ivr_call` where ivr_Call_id is not null 
group by EXTRACT(MONTH FROM ivr_call_dt) << 2024 filter needed >>"	"f0_	f1_
7	629075495
10	503609008
4	634723851
6	615201729
3	735280395
9	481387445
1	686289602
12	511353718
2	663936250
11	488120779
5	706711555
8	547445635"	Simple	
Please find the total number of calls received by agents for current <any> month	SELECT count(*) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact` where EXTRACT(MONTH FROM call_answer_dt) = 11 and  ACD_AREA_NM <> 'Prepay' LIMIT 1000	"f0_
58278474"	Simple	
Find the number of customers who called again in 3 days or more	"SELECT * FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.acss_repeat_call_detail` 
where repeat_same_day = 0 and repeat_3_day > 0 and call_start_dt > current_date() - 30"	<< 138K Rows returned >>	Simple	icm_fact
Find all Fixed 5G consumer customers who disconnect in the last 30 days with service period less 6 months	"SELECT
    cust_id,
    ordernumber,
    location_code,
    mtn,
    sales_dt,
    disconnect_dt,
    -- vz2_segmt_ctgry_desc,
    -- cancel_level_3_desc,
    -- cancel_level_4_desc,
    DATETIME_DIFF(disconnect_dt,sales_dt,DAY) AS days_To_Disconnect,
  FROM vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.fixed_5g_summary_fact`
  WHERE segment = 'CONSUMER'
  AND status = 'DISCONNECT'
  AND disconnect_dt >= '2024-11-01'"	<<88 K Rows returned >>	Simple	
find all the FWA customers who bought the service more than 3 days ago without pro install and still not activated it	"SELECT DISTINCT sales_dt,ship_dt, cust_id,mtn,ordernumber, location_code, status, install_type
                FROM vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.fixed_5g_summary_fact
                WHERE 0 = 0
                AND segment = 'CONSUMER'
                AND sales_dt >= DATE_SUB(CURRENT_DATE(), INTERVAL 3 DAY)
                AND ship_dt IS NOT NULL
                AND  (status != 'CANCEL' OR cancel_dt IS NULL)
                AND ispu_status IS NULL -- excluding ISPU and ISP
                AND (ntls_order_status_desc IN ('ACTIVATED', 'PLACED') OR ntls_order_status_desc IS NULL) -- exclude cancels and deactivated
                AND install_type != 'PRO INSTALL'"	"sales_dt	ship_dt	cust_id	mtn	ordernumber	location_code	status	install_type
2024-12-02	2024-12-02	z+0IiGZbLVEAYAeJ/G0anJ6/ZEyFDjfA6oyp7mRXTp22uBXPMLS3B82wjfAlqrsjMlmYfPZ+7LQ5HAOL3YqbNQ==	6zpmRSgip2WbHzkThnxu7rOb0H/xGUhK6fT54SUADbBZmIfox3DB1zwpgJpm6y33lUO+eKAyz15Fq3iGNx8AtA==	cYVQuM+ZCPlTch9apwjoBbqiM9T9K/rVh/p6tOxEES2XiR60kgK+aeCV5PnQkp8ALsB+XjWT3kiW4W45sHX22Q==	T316001	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	PIdHh88rzFOgpoS8h/cigXU/YQw2XIwNtPgEdmr9zUJZiI2YQlDyxS0r5oEm2rjt6QHkWaksQ78aM7b6Y/PpyQ==	t65LtdHv88PBpU2/3RFt3JwNMsCzjhzl98QmiGPvkaT6Nje2h4pjBWUrjJ6v7FJ/P6TorwCS038cpdAB4hUbGA==	TZwwy5icNnh0FlfvGNY6HruA8du5Ab7eYFBhU55GaBSr3+Xk1IdcieVRI3aqEcYAS7CDOdtlQs62nVWAAPQZZw==	N832401	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	LO6z+CBMfBRXnhRGPXzc5UMP1/4oVRtfgihw94+uMFWq7X0UB2YPKMY2F2STiEvUbxi3GEjXGGktCyecqHH+mQ==	Dj5TfZwtvPBlXHQ0Rs4Clqtom+HDAKsFy+aCdXSmSqYuhLZaYnZCkQzhd1kphBPr2BcpXH/w5rODExDFleF9ew==	1oDbhSwgDhGoAiYkFCWiuP14oZlJlQd8E3dBj57Fqg8icO7d292bYlTt7/8Gd5su+WvC9B0B3oFxRYbYGr+/CA==	Q740701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	eIDQ/nAOqh8ISpPCUfeK5AE4Rk9+2p3DdRimAwX3JY8aP6A/q9fWWpLnY3E7gKRzuHpVtKDSUHKq8lvLju9lWA==	1KfxdiiyDEIj92thuyegU+Hc+SOqBjsjL8QBt46GqXjLsNDnS5UJNZOmInJTbBPhzRy2CDHtj5VJApz04RkwTg==	vwmd/w1yHTCFAWVupmeudo97NE4V+jfDk1cfsRwhXZPWeKxRCvVMBvDW5lvF1czp00ZpeP6xC59/OJvQEPdm4A==	Q684701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	7FJox/32NKrRdRCDHqc9AC1DBiHgqJGrC0+DSUB533VdjTeEthcC46SkwRhyjrHiTAyEkY/+tZmQJBHi9novEQ==	uZteBICOYB28CI0/rZleXFDOhsEiMrQ5MII+4k4tr67M3kwNeZsYDu2O9kxOxGBrvlcyMUsvh9LeW3wdX9kI8A==	AkA7ief0y6f9oJsrkSFQkbCiW7O2vvUnKb5N7C9ySkRnGudh7+Fb/0FfMAMvY+o1vfhSiosVU5yd0SojVuaygA==	Q784701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	UxiZSg2ZZsnaPjAaYJK2zjHZSO+0SyidA+xMzkbzpD1Dw1PQ9a5BnV4PyKN3nPXp3Bo5nVPMxRXkGnNDw1aCFQ==	VxKgMaSx8aAxvUlFAfgzBRhHDW1kCRSceV5qjrtxLRhnugteEZZKrqRXpMWKelQI/euo4DkrDcIr+Te92Njbjw==	nylsO6Fg+gE1F6zRBzfS40Lly7d0PaFJuDbZ6Qv2tP5PUe9SUfj4FKBC0o/hbW2zZEHZyoXMfUnyMNknWMipfA==	1434901	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	eljMXXJnK5zxXbvwDqt3kTlVIOKFoBstiF7zs/iq4MnHSf0Cb5pwHgHL8yHsu1T/afQqhPiTM9QLyboAPhfq5w==	vJhsQ2ER70H7lv1xJfoDSBed6L+rqI+GOAPJ/epItDGAB6I8BwPVpXfXuLFphziSvFIb+EtxRBfnxf5afn2vJg==	2m+t9r37GVNisZYwHdrS9lZpz2TwO1MniIS2+6uaSrqCY3NktXFdg+zll+evT94sMmkviJFiSL78crq+/kmrWA==	E734001	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	QbOFfbLSiK0qpGff+mWk1t2eg87W5iIYZVor2xJ+6NhTg/dBRdwA6gWe9TFsBe1ghm6nMxEAl6svKHrXF3S75A==	abd6Z3qxlai+AgOEXsYwKFCMPIZskB7CefFN63ZHNZo4AlzPed6yUhuFYNtQFBCkRnDcF0mT81CgGfqjUUYwqQ==	vphnokF6bdGl4x9JuNaXs/mivqiN5L0x8nFgcJyfhSaP4lDhpCIRW9vQcRTxANCl++a/RdBcqbhMlmUEnbrFbQ==	1434901	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	JUyTirC878rGc4ioK0U31O/prln5D1pazPwtr5leBGqeBT9yUPwMS/okFYITogFmTQgVZ7NI4RHgnRY9EqOcEA==	bJtzxTRWomEkPR2bDvv0Ws11gQhiJcYB5oLxihfZH1nJRqWPEj4AQPQWrVJP+FZTg3r8am+hrRnuav3Z9LyQWw==	7a4aRangVrip13KQgwmsRmuWy9NQayEi1tczpvn53yZBLW52LUh2kdBV3dFMNJbb8p9VXMgTck4xle09s4bbZA==	Q788901	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	hfuatJ9VodCpuPvDStkxZduv6wyY85+6kPsstTzIfGjdLmZIWAKYhMt2m0H5JWWl4j35kJy3kENkRIzLTR2pPw==	SoJax2ZxnGzZeExQAQ3MYPYAexCj0YNxMKmDZJzmmGGGNeXdJxpN7y4KXOq5jjTlvMiuaP9TbdlpuProtvGtvg==	yaz3r55S5BsIp02QNvLGR1OQQ5DFl2nqnyTqenJ/VAVHq93fa0aOrDgJ+ozkzCEuAU8XzcvCZiRzEq1QwIR7ag==	T360501	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	w43l/zLZJ5HQvHDHy0ywBIGXvvr9GZuqoz4sxBwMbsO0f2V4jjhuZKWeR7Hdk2RyhHH8XM3uGmEVBFFg5wsyhA==	gD4zT7bjOZKi3zru1XNdEf/DZQdj/9wmVgjMsDapxmxoGIXW8yc86TN5TVMgo0ryw3r7BoVWgaxA/nWzZZWBYw==	Snd4OAPpwyb6xU9salbswkfra6HYViVIksmCiLIMkQ8NmF2WnKHC6smZmxi+KcoH42Pmlg8gjz1696wNgUH9tA==	T281901	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	mOPH2wkkWrMEG4WaeMU9MZpfzZjCcPMHrTuGpkD64e+d7vhicEbiQVTmwFTdMjTNPl2DwJ6phQe2oCpumxNkBg==	EaUWNsY88AZRIoDJGqXNy/d59fx5gRw7YoMxL/sxY+F3W+1u7Gsz4Se8cksfuUy+bXqBxxKALt1lu/wYBarZ/w==	/qBI/nadUUe8xVCWJKxubTTVgQb0jcL9bX+BVuRlecSJeY0ygAexcKeuwz3/W+2jpmXSnuKRL0tUn9PhBjGfmg==	T310901	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	z0MpOwv5zNOtR4YFRE4c3Mtk0PZBSfsc9/1G7WFfVP46kU4NP+H56aU89gzz6sfxeYoku4uEjMhqS19b6j/d6g==	Kbfo6w3vBj9+klGWvHLOpJPjs8RsgAHEmbWGyOkiGx8RF0eOUimvwKcVGE6DtVykLi1CFbkZeUckdc+eD8hZYA==	xBQTv8lNnAAZgIYwmts1dWKUW7ymT7laiQ1WJ4nQJKMkZ9bZ6EDXl2Sd/HzCFSwx6QKrtEL9c10ILCe9JH6qiA==	T232701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	ajUSv5pTJcIoFDS2eSRlHTM36cYMLuNd45tbAdScndcWK/t2bGJZPUhDnDOJh0JWemtWKqQo64zYPmkjp0cz2Q==	3HWKZd0cUY3rOxPen4C0a8bBoQTvYqjSSGZflNoz4dL+fXaINaFm/YGCJ5J4ZU2dstjT8HYdIZ7iAYCKy+Un+g==	1EVeTn7+mJWVsn7WV68x6qWHDJSW8p18lP6sVXCB8PPj9hOiHFXyWzawg5jfMwsWjGFQcjiPetIBsiMs6MY7ug==	Q786401	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	aZmdWQw6oHU/Wj9/lrhdR7HaJD5MO/x66SexYQjRNzGMC+nAt7Yk7UYzjR+/Ycfhi/vyS8iogr/Ux8teaaUWYw==	Dg4DKQfMnVcqun7VQKo1pDthRtFFwMYwkQ6iIDLo4mvTIduWcn4/ySFdT0+s7NT/JAacTXufAFCsW+pImCwgEw==	jw7QelVQ/LJ3X1g6wrB6X1ExldP+cN7fC/f1zelzPcphcuhNhA2jtC4Mc/viwLwhrYY23O3BPJQmkb33AoY16A==	T282901	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	X7evtYkHZRLx4Ci+pwPl+Y5Ca+v7S2Xci2AeL9JCKJyHUua1LXB7EQj7HR5UI/avU8K3KuUUP2/yOLoFrMT06A==	TMsflhqsI9VTXZQg+nGzLTFqUxwy+zr3KKOALzX0OuizaVakgn1G23uuoY24Dbj54bMdhXXQFqqwROArf4/MBA==	yS03aVF2F1rZ4Jm3qsbBgFMUyN9f40fjfPglJZJZ+Ivj91wvnE9owCqDlgMR1qXyNVHt5NT9YA9ylPjABaHoeg==	T350701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	mTrjVQ2/evb61hSQ+KyPxxZWMbyUk34SlY61h2Swjtb0lLVj4LYrsR/cBVNLmE6FtNXSaJvI7vO3XAlr72bMLg==	CjwG5RnEHm+nMP06hbQ6E5T5n2WuH5V2ZfdWwkX/axC6lbkpyV4gkwYVX9V/XYn/HTrK92MKgKlvOoXFnd6vcA==	Ttw++hXU02Z2rV7TwPHLP5ItVgMzE5t7ahEzytXuKOz9wlD0GZ+aKQYH5TRvItz27nOOL7qZY8PSeaOF/OOwlQ==	N832101	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	Rg5EtMzXr+Nw+cnvkuu7cwbB6EYKSbWk2TnKHC1iDx+V2Kic4T26RRFVjrZO0doTP87P3zvUVPlijRKZp3BB4Q==	K2fX51RZFQds+1oAL4B+2H6lREO0WdvuRGf9g6Rz674V/YWgacgqq6nuccJbtC2uPeFdNBshv3ZrWv32195pjw==	xpnJBXLdGk4TGXf76T4UJc0wkZeQOmRO5fEfZDENMEPL6pcTEl4glTWwbJdZVUr2frr2KxwuXdOIhMmvEfJlMA==	P175401	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	vvSVX5tef1Bu2oNZN6sgRxOxk//HmeySV5dCnoHKXDUghwWzfyQ1gOj4lO0O8r1Xs9YBfNSyDs184/EkhTNnfw==	Km4ou3IUP4rdK1okcNiZHvF6TVtx9AJJpYXMYujCLg36nUOpyofW/89xenFRLhiG9LfA6qsFQk/JnLH62X23SA==	TcHf7QIUDlbU1i+7Ilh4VR31PbxjHpuMqlBIbI0R9Exmyq2yuWYcczyIPpvK38XdfQf4yInMq/IhVfVGYDLDPw==	T330301	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	vsoP7phJvjPIcYw4ZTtE0hOfUc3phK9N97LWVXDJ89TXS0mO1saWE1Qt7WID5NqVERdN+HPjeBcnGQ2iOSniWQ==	7TEZaeEWTfQpDOZVSypWGymXVciQUtyn59tOUbeewqPUpr4L9XcBHWvsrpNzBC8oiRpvbO5KI2+oAo+fd7M6Ig==	BxDgngdfW356IJbYofRsQTgK6dPJpqvHRy3s2q+dm9PI/iE67QLCzbn1lrypuoCy7QMmiDD5ppTwtsN4739vkw==	N832301	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	lzDzAaivFSf/IpX5abSuqqwllycUrboK5LT42jwOEPmsQDHrZA2QiQGSwZR5fqsfXQfKrAqRuF+ez7Rp5Um5xg==	NiH3NtCsEqzgT8tRTIQ8gWtj4ai/IVk4LJc4sWAvwrDKo0y4FvyB4ArTSTaIWZbbQ4G0kPsVhIFnXlZQU2+XPw==	Dx3mEO3hOqrMUXdBCoxummuMBiRiFTeYLvUBG4rlpr4w3mtztZvZvMfuM2H9c7jvN+v0SjewG0gfIOTDU0mGEA==	Q740701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	Dgl+iC8+6IZ5pdfWZUaK5McKhVZzJO4fkv6fhr9bmv8iY+oQf5+93a5lnTxucQm3sdJmQJXH3vVBQn8c6D1PtQ==	vZ6PiVxIfS4+m86EQkFDBoxGUkpxVqiOZnSVn7AdTgH1kaEkpnXX7X/H10RtzTQgQdkdtErp6ZVfPZ3vh/T9eQ==	G3H3dsp3PJulbRNeSdtNn6cKk122w/ewWvyr6YAZXKpImPECkUDDEako5rJHVq7Kaeceg6fKo5OACT7UsKBL6w==	Q740701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	KHQ3f+z2yaDLwdxFQn8k5y08tod5obr5ovBlBoGCbJZd6JemRtIWbGelIZdj50X1givDOR8J/rpTJq6+70b0aw==	JjtNirjc6Dqg7GMA66t1FDjfytbaGH8pHWmklA+sy2fL0NGN/YKR8E9oCVZ59u/KOUuTMZJ8vLe1zymmys7yrg==	izM9mvksxKUJNOHn6gFalIUhJy074fsAzPnz0f7UogeZElyn3bpDb97VNq15bhXvKx6X4kGuvlEFpdWpA+4b1A==	Q769601	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	mhnTE0NeMNwIpnH7Dm72rgPjiYvLHmMrBG+VoajBvzzuzoIKA76yQZr+Gl33TGsGZMTo5VKxF8zGzJyYCJWFhA==	TCHrKjstQytrTzXqAaU65a3OhAGYuxalORBu0JvlZNzNtCfXvTArSf6z3W0Wqy9VOypIdFYQiazMcgrgE0cGLg==	tB3jshx8OPQpaRwso/KW4+3HpdOYXqW2aWvFVZ6HlS+6a8DXjSciXLWusxjCESoyntThWHQhG9B6rav4ijiwiw==	T282901	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	JutkNRwLmm34fCSGDYo3Le6Pau0R2SR1xD2QgH1cR21DVUxvsAKUXQvVbkVTCElWJVR3qUloTCSzlgO5LJLojw==	NaNkRcnwaOzb580O0PA/Ty2WAiYPl/fWhelwCVu07hVoHKGL3rMQ6Q1WOZWh44sEntdB0cxUkFAgPNk6TAS5og==	k7PX8mvLSwotJGcGMaGzGBmxdpsY70/XDz8aS+JLU+XICn3nMyA6mGOyGPRxKxAkrIeE+hHSzMI/JoBBYEsXKw==	N832201	PENDING SETUP	SELF INSTALL
2024-11-30	2024-12-03	F8Ku4cVnUE+Cz8YY5PyaGm8LQ5AOs1G8j+EJ2t2HHiupL/8Q49wut3lwktxd3Y21NxYr+Ci8QnDuj8FpFMtTEA==	eqpZGz6OtGS5zM2IHptxPGJ3lDjmasDD0wxb8kGn93YWhhECYzTd5hY13+c1VcepcAs5+Vb97e83MtsmBTpaPg==	ukMSBPYHdiH12Vt52acrBl2DMNkhwM4SSdpNgQZ8GwJbps9dmI1VsmTi7DcDDlLxttp+7xh+da4jeJEeNjDDhg==	D031501	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	Fi3vPg3aS4X0o8lwPX9rouWirWueALfMtmyBUG9+uCrcgJpCU0mwTk4nBENoF36DeaY8/WE1v2AxvuBiGoqw3w==	gZA7ENQWVBEOz0WK9rAnMeddphZlkaRbNvm5R/nN1abpPSCASxvDCTLBYE289QciOEnsCCPfgT70bjv65AksCg==	ZN3pW2sd6lxfko8X8M/TlAvXDsBkpN3DvpiT9pgri3N0M5AvZtIX/vs1Dk8xTJAKxDUUshv+wh3JTnZsNskmHA==	Q784701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	WYHPBckmOCZDCrlkwCjk9DkECrBRYhnBfvr5g1zUzZPnmPuApu2PSNfieQDFqfzYsHY/1KjlOxPuEAUx6RZR8w==	zRjrAYNXL/A0/bU+9ZVNej0i+RvQ0CdsIUCtZaKh3/f2sgvfx4bvK7bg2eXZYlXtTQ59Amn5S/PqEXOpfg8n/Q==	iG7MqvMWkSYQRZIKveeAPHukaqN+NJYdfqE7J6HQomWJmA51QrNI//oZUjeQadET52dhV3mL7nEiVa2eZn0fRQ==	T233801	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	Gt/EOvr2p+u+DmgvFSPScx2kEug/gLQY3YNQaq9k9BRYwWTEAC9EcKO1Dx2r4vVeb9zbKIY9w7/7FMSuMAs3sQ==	s8vX2QYf8HaZsuRgYvj3to3HzWPDYASuZo52hTsbQX3BOta+rtJHOwAXZ2ctZMwwKY8fN31TcqRswpebAOnUBw==	5/k7LSJOHazSm74pVGE1Tjk/IA+/FsoXSf3/F+ItMDV6z6HICMf+orhNaQu9kaqfdQOznNYuD5RFq92I0SnIxA==	Q740701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	WhQ5b8CFUUBUYESXs9lk39s/23svGtINiml5f7Cf/nziI33BsA6W4NFn7JiezpZMjSySFEfnchw7xpQZg+4bdA==	4pZYZ9sOKJrAG9+iamY75jU1cktBY32Ubzqcjdrnh3cpUEezEQSgRIfPwCl4WRxzuaDMFT4pNw67YOHNj41quw==	gLbMB8/MFwnw1wkVKqkVmfExOuRLF5bDqddJbxKd35P+rCrm0CJZbTI9Px+KMDaoqMOTpIjWdoRXYgaR7x/pXA==	T350601	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	OeeXZNfLELxFLCWyhvrBJQFNvVkFVAGeZVZDWP/+TK6BW8rc8uwO4rGtBMW/lSFEa78dWsJjt2FqP0qmGeWu5g==	wGnt5iDmMGgN63IkCD3hFtCKDIYHkhzHcxOSnxQ96h3bMA5RO1xYbbFVyR9MgJb6dsddZIwdT/u4GfYcUKWpCQ==	3XHL9HJgBycgmY6RrXlHosft+vZnd9o5iKbt2EkUBgFZG+/xCJ15FZQ9b5cVqN+bw4imOQ+ObaJBuTM4fFMN4A==	Q684801	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	m2SQitZSpwOnPA8O9kg9pL/5Bgt61QB4Meh+hERdpG77DxJiagY6lHq7UHYrirpamaSEJvTX6uOvIi2fqEENUA==	nIyfq0NTtavsm0xUlAa8C/2t+YQNFPyz0FBiefFjiIXSRHC2lYh2WGylJNckTaSrbP6bugA8+DI1P3L8oDBTVA==	xEBpBY/TkpAPkqDRv5TOe+wwqvWXoIHL1krphL/kgdeWUgISG/PhdjQYfAt9XRO0/YKjhYrnpyIrnFdn7/pM4Q==	Q695301	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	itkRrmJp4NALgdUQx8LWNR/SOdPHzVYl6DGIHKTOL3DenfSoyGi+Az0fBvTK/4cbfkhDGV6GnoUGa+Ls/KcnTA==	v2SUU2xFGOkov2TsvgLk9fms6wd3C9f1u/C780zZntbIlJB6zJO1pIbxUHE35eKu44CpBtZs65CqlP0oqg1T0g==	DSHDg9jGSCFVpbnGte1hbnUrS97QDMCPA9A7VRWL1/MTiZMmSFn5OOQGvvSkU0XY//VUz9LGXCSXWOmi0fPt1w==	Q740701	PENDING SETUP	SELF INSTALL
2024-12-02	2024-12-02	UKTi9iq9tpSzjDLVFFSVwsDg++QiROKtwy49Mevf7a+9MVnQHZ4yIwDzaqBfSw7Ofj9er0q/cJHKj7lrLdifYg==	bDEE7EzxX3NEPZ/l8OvhcGXmMkjssKVUYmpvG2UGUr/Kl8i3I1WqIDrFijwBfMN5PuFvPVe+/F3j22rRflOGfQ==	09JscyET9LpelMFJRcFblsueBwy6CgH0iXG3NP2aI9+9djqA4QJm1We8wgm7FzWLTG++DguwHI8z3u8ij6/wlg==	T366101	PENDING SETUP	SELF INSTALL"		
Find the overall call handle time by Call Type and separately for Internal and SPC for given date	"SELECT
    isf.CALL_ANSWER_DT CALL_START_DT,ISF.ECCR_SUPER_LINE_BUS_NM AS CALL_TYPE,
        --FWA_IND,
        CASE WHEN isf.ACD_AREA_NM ='SPC' THEN 'SPC'
    WHEN isf.ACD_AREA_NM IS NULL THEN NULL
    ELSE 'Internal' end as Area_nm,
/*  CASE WHEN isf.ECCR_DEPT_NM IN ('Care','Other','LNP') THEN 'Care' 
        WHEN isf.ECCR_DEPT_NM IN ('Tech','Tier 1 Tech') THEN 'Tech'
        ELSE isf.ECCR_DEPT_NM END CALL_TYPE,*/
    Sum(isf.ANSWERED_CNT) CALLS_ANSWERED,
    Sum(Cast(isf.HANDLE_TM_SECONDS AS BIGINT)) HANDLE_TM
FROM vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact isf
WHERE 
isf.ECCR_DEPT_NM IN ('Care','Tech','Bilingual','LNP','Other','Tier 1 Tech')
AND
isf.CALL_ANSWER_DT  = '2024-11-22' 
GROUP BY 1,2,3"	"CALL_START_DT        CALL_TYPE        Area_nm        CALLS_ANSWERED        HANDLE_TM
2024-11-22        Customer Experience        Internal        111921        122525767
2024-11-22        Loyalty        Internal        32237        35611971
2024-11-22        LNP (App)        Internal        6807        5742565
2024-11-22        LNP        Internal        494        311484
2024-11-22        Technology        Internal        35406        46764343
2024-11-22        Customer Experience - Bilingual        Internal        6033        9279849
2024-11-22        Loyalty - Bilingual        Internal        1620        2319583"		
Find the total number of calls transferred in the last 30 days by day wise	"select call_answer_dt, count(ivr_call_id) from (
select        
                        call_answer_dt,
                        ivr_call_id,count(distinct acss_call_id)  as call_transfer_count ,
                        sum(handle_tm_seconds) as handle_tm_seconds,
                        sum(call_duration_seconds) as call_duration_seconds 
                from         
                        vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact
                where 
                        --call_answer_dt between date_sub(CAST('2024-10-06' as DATE), interval 15 DAY) and CAST('2024-10-06' as DATE)
                        call_answer_dt between '2024-10-24' and '2024-11-28'
          
                        and acss_call_id is not null
                group by call_answer_dt,ivr_call_id)
    where call_transfer_count > 1
    group by call_answer_dt"	"call_answer_dt	f0_
2024-11-02	18191
2024-11-10	9476
2024-10-28	25204
2024-11-27	22599
2024-10-30	24997
2024-11-05	24794
2024-11-12	23464
2024-11-11	23320
2024-11-09	17079
2024-11-23	17288
2024-11-03	10224
2024-11-20	22726
2024-11-07	15393
2024-10-24	23725
2024-10-26	17721
2024-11-06	23947
2024-10-25	23489
2024-11-25	24972
2024-10-31	23992
2024-11-16	17236
2024-11-21	23192
2024-11-01	24238
2024-11-19	23415
2024-11-18	23534
2024-11-13	22233
2024-11-22	23675
2024-11-15	22413
2024-11-04	25389
2024-11-14	22064
2024-11-24	10060
2024-11-28	3470
2024-11-26	24231
2024-11-08	23059
2024-10-29	26006
2024-10-27	10260
2024-11-17	9619"		
Find the total of prepaid and postpaid calls to IVR in the last 30 days	SELECT prepaid_ind, count(*) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.ivr_call` where ivr_call_dt >= current_date() - 30 group by prepaid_ind LIMIT 1000	"prepaid_ind	f0_
Y	2616236
N	27278008"		
Find number of bills generated for each day in the month of october	SELECT EXTRACT(DAY FROM bill_dt), count(*) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.acct_bill` where cyc_mth_yr = '202410' group by EXTRACT(DAY FROM bill_dt)	"f0_	f1_
1	1570231
2	1425732
3	1415475
4	1411199
5	553678
6	1471881
7	1402077
8	1122178
9	1403354
10	1374950
11	557352
12	1554808
13	1417823
14	569970
15	1547725
16	1429549
17	556095
18	1525340
19	1422819
20	1433314
21	1406310
22	1412307
23	1275771
24	556703
25	1579581
26	1434153
27	599779
28	1660890
29	521422
30	492421
31	291204"		
Find the sum of all late fee reversal in the month of October	"
SELECT sum(late_pymnt_chrg_amt) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.acct_bill` where late_pymnt_chrg_amt < 0 and cyc_mth_yr = '202410' "	"f0_
-237216.91"		
"How many trade-in orders for the month of October
"	SELECT count(*) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.equip_sum_fact` where tradein_ind = 'Y' and duplicate_ind = 'N' and rpt_mth = '2024-10-01' and area_cd = 'MW'	<< 875045rows returned >>		
How many active lines have devices older than 24 months	"SELECT count(*) FROM `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.device_usage_age` a
left join `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct_line` b on (a.cust_id = b.cust_id and a.cust_line_seq_id = b.cust_line_seq_id)
where 
b.mtn_status_ind = 'A'
and b.vsn_cust_type_cd in ('PE', 'ME') and
usage_months > 24 and
rpt_mth = '2024-10-01'"	"f0_
38749334"		
Find total number of new customers in the first week of November	"
Select 
distinct 
                        ESF.CUST_ID,ESF.MTN,ESF.ACCT_NUM,
                        esf.invc_num,
      COALESCE(ESF.INVC_DT,ESF.PYMNT_DT) as Sale_DT ,        
FROM
vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.equip_sum_fact ESF        
LEFT JOIN
                        vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.cust_acct CA ON
                        ESF.CUST_ID = CA.CUST_ID AND
                        ESF.ACCT_NUM = CA.ACCT_NUM                        
WHERE 
upper(FIN_TOT_FLAG)='Y' 
AND upper(ORDER_TYPE) = 'PS' 
AND upper(ACQ_RET_IND) = 'A'
AND COALESCE(INVC_DT, PYMNT_DT) BETWEEN ACCT_ESTB_DT AND ACCT_ESTB_DT + 60 
AND upper(ESF.SOR_ID) ='V'
AND upper(ESF.ROW_TYPE_ID)<>'PR'
and TRADEIN_IND is null
AND COALESCE(ESF.INVC_DT,ESF.PYMNT_DT) BETWEEN '2024-11-01' AND '2024-11-07'"		Complex	
Find the surge caller (customer who have called 3 time or more within 7 days) for last 3 months	"select cust_id
,mtn 
,cust_line_seq_id
,'ACSS' as channel_cd
,date(call_answer_dt)
,case when call_num > 3 and repeat_calls between 0 and 7 then 'Y'  end as surge_caller
from (
select DATE_TRUNC(date( a.call_answer_dt), month) as call_mth
,a.mtn
,a.cust_id 
,a.cust_line_seq_id
,a.acss_call_id
,a.call_answer_dt
,a.call_answer_tm
,ROW_NUMBER() OVER(PARTITION BY DATE_TRUNC(date( a.call_answer_dt), month),a.cust_id,a.mtn order by DATE_TRUNC(date( a.call_answer_dt), month),a.cust_id,a.mtn,a.call_answer_dt,a.call_answer_tm asc ) AS call_num 
,date_diff(cast(max(a.call_answer_dt) over( partition by DATE_TRUNC(date( a.call_answer_dt), month),a.cust_id,a.mtn order by DATE_TRUNC(date( a.call_answer_dt), month),a.cust_id,a.mtn,a.call_answer_dt,a.call_answer_tm asc) as date)
,cast( min(a.call_answer_dt) over( partition by DATE_TRUNC(date( a.call_answer_dt), month),a.cust_id,a.mtn order by DATE_TRUNC(date( a.call_answer_dt), month),a.cust_id,a.mtn,a.call_answer_dt,a.call_answer_tm asc) as date), DAY) as repeat_calls
   from `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact` a 
   where date(a.call_answer_dt) between  '2024-07-01' and '2024-10-31'
   and a.cust_id is not null
)"	<<30 M rows returned >>	Complex	
Find all customers who were put on hold for more than time 5 mins in last month	"select a.cust_id
,a.mtn 
,a.cust_line_seq_id
,date(call_answer_dt) as signal_dt
,ivr_call_id, cust_value, high_risk_ind ,transfer_point, eccr_line_bus_nm,ECCR_DEPT_NM,ecc_sm_ind,answered_cnt,acss_call_id,talk_tm_seconds,hold_tm_seconds,hold_tm_seconds,transfer_flag,call_answer_tm,call_end_tm
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact a
where 
  date(call_answer_dt) between '2023-10-01' and '2023-10-02'
  and answered_cnt = 1 and hold_tm_seconds > 300"	51K rows returned		
Find all customers with overall talk time greater than 5 mins for last month	"select a.cust_id
,a.mtn 
,a.cust_line_seq_id
,date(call_answer_dt) as signal_dt
,ivr_call_id, cust_value, high_risk_ind ,transfer_point, eccr_line_bus_nm,ECCR_DEPT_NM,ecc_sm_ind,answered_cnt,acss_call_id,talk_tm_seconds,handle_tm_seconds,hold_tm_seconds,transfer_flag,call_answer_tm,call_end_tm
from vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.icm_summary_fact a
where 
  date(call_answer_dt) between '2023-10-01' and '2023-10-31'
  and answered_cnt = 1 and handle_tm_seconds > 300"	6M rows returned		
How many customers moved from lower decile to high decile from last month to current month	"With lastmonthlowdecile as (
select cust_id,cust_line_seq_id from  `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.churn_sum_fact` where
score_decile_in_mkt in (1,2,3,4)
and mth = '2024-10-01')

,currentmonthhighdecile as (
 select cust_id,cust_line_seq_id from  `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.churn_sum_fact` where
score_decile_in_mkt in (8,9,10)
and mth = '2024-11-01' 
)

select count(*) from currentmonthhighdecile a left join lastmonthlowdecile b on (a.cust_id = b.cust_id and a.cust_line_seq_id = b.cust_line_seq_id)
"	"f0_
22446407"		
How many of our unlimited ulitmate customers are in higher churn and has issues with our price for october month	"select * from  `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.churn_sum_fact` where
coe_pplan_sub_type_desc = 'Unlimited Ultimate'
and score_decile_in_mkt = 10
and primary_driver = 'pricing'
and mth = '2024-10-01' "	79K rows returned		
How many of our unlimited ulitmate customers are in higher churn for october month	"select * from  `vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.churn_sum_fact` where
coe_pplan_sub_type_desc = 'Unlimited Ultimate'
and score_decile_in_mkt = 10
and mth = '2024-10-01' "	"f0_
356493"		
Find total number upgrades in the first week of November	"Select 
distinct 
                        ESF.CUST_ID,ESF.MTN,ESF.ACCT_NUM,
                        esf.invc_num,
      COALESCE(ESF.INVC_DT,ESF.PYMNT_DT) as Sale_DT ,        
FROM
vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.equip_sum_fact ESF                            
WHERE 
    acq_ret_ind = 'R'
    AND NET_SALES>0
    AND FIN_UPG_FLAG='Y'
    AND upper(ORDER_TYPE) = 'PS'
    AND REV_GEN_IND='Y'
AND COALESCE(ESF.INVC_DT,ESF.PYMNT_DT) BETWEEN '2024-11-01' AND '2024-11-07'"	207K rows returned		
Find total number AAL in the month of November	"Select 
distinct 
                        ESF.CUST_ID,ESF.MTN,ESF.ACCT_NUM,
                        esf.invc_num,
      COALESCE(ESF.INVC_DT,ESF.PYMNT_DT) as Sale_DT ,        
FROM
vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.equip_sum_fact ESF        
                 WHERE 
upper(FIN_TOT_FLAG)='Y' 
AND upper(ORDER_TYPE) = 'PS' 
AND upper(ACQ_RET_IND) = 'A'
AND COALESCE(INVC_DT, PYMNT_DT) NOT BETWEEN ACCT_ESTB_DT AND ACCT_ESTB_DT + 60 
AND upper(ESF.SOR_ID) ='V'
AND upper(ESF.ROW_TYPE_ID)<>'PR'
and TRADEIN_IND is null
AND COALESCE(ESF.INVC_DT,ESF.PYMNT_DT) BETWEEN '2024-11-01' AND '2024-11-30'"	624K records		
Find last month trend of Upgrades	"select sale_month, count(*) from (
Select 
distinct 
                        ESF.CUST_ID,ESF.MTN,ESF.ACCT_NUM,
                        esf.invc_num,
      Extract(month from (COALESCE(ESF.INVC_DT,ESF.PYMNT_DT))) as Sale_Month ,        
FROM
vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.equip_sum_fact ESF                             
WHERE 
    acq_ret_ind = 'R'
    AND NET_SALES>0
    AND FIN_UPG_FLAG='Y'
    AND upper(ORDER_TYPE) = 'PS'
    AND REV_GEN_IND='Y'
AND COALESCE(ESF.INVC_DT,ESF.PYMNT_DT) BETWEEN '2024-07-01' AND '2024-09-30')
group by sale_month"	"sale_month	f0_
11	1135366
10	868725
9	860649
8	837944"		
Find the voluntary disconnects for the month of september	"SELECT 
cust_id,acct_num,cust_line_seq_id,mtn,
channel_type as channel_cd
FROM vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.dla_sum_fact d
JOIN vz-it-pr-gk1v-cwlsdo-0.vzw_uda_prd_tbls_rd_v.vz2_segmt_dim_ref v
ON (d.vz2_segmt_cd = v.vz2_segmt_cd  AND v.curr_prev_ind = 'C')
WHERE rpt_mth = '2024-09-01'
AND activity_cd IN ('DE','D3')
AND voluntary_disconnects >0
AND line_type_cd NOT IN  ( 'H','O','T' )
AND upper(sor_id) = 'V'
and COALESCE(upper(PREPAID_IND), 'N')= 'N'
AND v.vz2_segmt_ctgry_desc = 'Wireless Consumer Revenue'
AND data_tier  IN ('Smartphone','Basic')
AND upper(vsn_cust_type_cd) IN ('BE','PE')
--GROUP BY 1,2,3,4,5,tenure,pplan_cd,device_prod_nm,change_reas_cd,curr_contract_term,port_status_cd;"			
